{{ define "main" }}

{{ .Content }}

{{/* Intro summary section */}}

{{ if or .Site.Params.homeIntroTitle .Site.Params.homeIntroContent }}
<div class="intro">
    {{ with .Site.Params.homeIntroTitle }}
    <h1>{{ . }}</h1>
    {{ end }}

    {{ with .Site.Params.homeIntroContent }}
    <p>{{ . | markdownify }}</p>
    {{ end }}
</div>
{{ end }}

{{/* Social Icons */}}

{{ with site.Params.social }}
<div class="social-icons">
    {{- range . }}
    <a href="{{ trim .url " " | safeURL }}" target="_blank"
        rel="noopener noreferrer me"
        title="{{ (.title | default .name) | title }}">
        {{ partial "svg.html" . }}
    </a>
    {{- end }}
</div>
{{ end }}

{{/* Projects Section */}}

{{ with .Site.Params.projects }}
<div class="projects-section">
    <h1>Projects</h1>
    <div class="projects-grid">
        {{- range . }}
        <a href="{{ .url }}" class="project-card" target="_blank" rel="noopener noreferrer">
            {{ if .icon }}
            <img src="{{ .icon }}" alt="{{ .name }} icon" class="project-icon" />
            {{ end }}
            <div class="project-info">
                <h3>{{ .name }}</h3>
                <p>{{ .description }}</p>
            </div>
        </a>
        {{- end }}
    </div>
</div>

<style>
.projects-section {
    margin: 2rem 0;
}

.projects-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 1rem;
    margin-top: 1rem;
}

.project-card {
    padding: 1rem;
    border: 1px solid var(--border);
    text-decoration: none;
    color: inherit;
    transition: border-color 0.2s;
    display: flex;
    align-items: center;
    gap: 1rem;
}

.project-card:hover {
    border-color: var(--accent);
}

.project-icon {
    width: 48px;
    height: 48px;
    object-fit: contain;
    flex-shrink: 0;
}

.project-info h3 {
    margin: 0 0 0.5rem 0;
}

.project-info p {
    margin: 0;
    opacity: 0.8;
    font-size: 0.9rem;
}
</style>
{{ end }}

{{/* Collection Section */}}

{{ if .Site.Params.homeCollection }}

<div class="list-container">
    {{ with .Site.Params.homeCollectionTitle}}
    <h1> {{ . }} </h1>
    {{ end }}

    {{ $pages := where .Site.RegularPages "Section" .Site.Params.homeCollection
    }}

    {{ $paginationSize := 1}}
    {{ if (gt .Site.Params.paginationSize 0) }}
    {{ $paginationSize = .Site.Params.paginationSize }}
    {{ end }}

    {{ $paginator := .Paginate $pages $paginationSize }}

    {{ range $index, $page := $paginator.Pages }}
    {{ partial "post-entry.html" $page}}
    {{ end }}

    {{ partial "pagination-controls.html" $paginator}}

    {{ end }}
</div>

{{/* 88x31 Buttons Section */}}

{{ with .Site.Params.buttons }}
<div class="buttons-section">
    <div class="buttons-container">
        {{- range . }}
        <a href="{{ .url }}" target="_blank" rel="noopener noreferrer" class="button-88x31">
            <img src="{{ .image }}" alt="{{ .name }}" width="88" height="31" />
        </a>
        {{- end }}
    </div>
</div>

<style>
.buttons-section {
    margin-bottom: 5rem;
}

.buttons-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    justify-content: center;
}

.button-88x31 img {
    display: block;
    image-rendering: pixelated;
    transition: transform 0.2s ease;
}

.button-88x31:hover img {
    transform: scale(1.2);
}
</style>
{{ end }}

{{ end }}
